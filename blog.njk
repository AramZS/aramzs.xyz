{% extends "_includes/layouts/page.njk" %}

{% set allPosts = collections.post | excludeStubs | excludeTypes(['mirror']) | reverse %}
{% set postsByYear = allPosts | groupByYear %}
{% set title = 'Blog Archive' %}

{% block content %}
    <h1>Archive</h1>
    <p>There have been <strong>{{ allPosts.length }}</strong> items published since April 20, 2007:</p>

    {% for year, items in postsByYear %}
        <section>
            <header>
                <h3>{{ year }}</h3>
                <nav>
                    {% set postsByMonth = items | groupByMonth %}
                    {% for month in range(0, 12) | reverse %}
                        {% set label = (month+1) | padStart(2, '0')  %}
                        {% if postsByMonth.get(month).length > 0 %}
                            <a href="/archive/{{ year }}/{{ label }}">{{ label }}</a>
                        {% else %}
                            {{ label }}
                        {% endif %}
                    {% endfor %}
                </nav>
            </header>
            {% set displayContentType = true %}
            {% set postsList = items %}
            {% include "_includes/components/post-list.njk" %}
        </section>
    {% endfor %}

    {% include '_includes/components/hot-topics.njk' %}
{% endblock %}
