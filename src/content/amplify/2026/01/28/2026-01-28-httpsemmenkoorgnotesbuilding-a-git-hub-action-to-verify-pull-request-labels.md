---
author: emmenko.org
cover_image: >-
  https://emmenko.org/static/dd044dcd895265c2ada6b71663ff19be/2f960/photo-1495568995596-9e40959aa178.jpg
date: '2026-01-28T22:38:19.048Z'
dateFolder: 2026/01/28
description: >-
  Learn how to build your first GitHub Action in a few steps. As an example, we
  can build an action that checks if labels have been assigned to a Pull
  Request.
isBasedOn: >-
  https://emmenko.org/notes/building-a-git-hub-action-to-verify-pull-request-labels
link: >-
  https://emmenko.org/notes/building-a-git-hub-action-to-verify-pull-request-labels
slug: >-
  2026-01-28-httpsemmenkoorgnotesbuilding-a-git-hub-action-to-verify-pull-request-labels
tags:
  - code
title: Building a GitHub Action to Verify Pull Request Labels
---
<figure><img alt="" src="data:image/svg+xml;charset=utf-8,%3Csvg height='477' width='768' xmlns='http://www.w3.org/2000/svg' version='1.1'%3E%3C/svg%3E"/></figure>
<figure><picture><figure><img alt="Photo by Mari Lezhava" data-gatsby-image-ssr="" data-main-image="" sizes="(min-width: 768px) 768px, 100vw" src="https://emmenko.org/static/dd044dcd895265c2ada6b71663ff19be/0c367/photo-1495568995596-9e40959aa178.jpg" srcset="https://emmenko.org/static/dd044dcd895265c2ada6b71663ff19be/7ab37/photo-1495568995596-9e40959aa178.jpg 192w,/static/dd044dcd895265c2ada6b71663ff19be/ce980/photo-1495568995596-9e40959aa178.jpg"/><figcaption>Photo by Mari Lezhava</figcaption></figure></picture></figure>
<p>I've been playing around and using GitHub Actions for some time now and so far it has been a good experience. I also started contributing here and there to some community-built actions and that gave me a chance to deep dive into them.</p>
<p>To my positive surprise, it's actually very simple to work with them. Kudos to GitHub for building a very accessible framework!</p>
<p>With that in mind I decided to build a simple action that I could try and use at work. The idea is to build an action to check that a Pull Request has at least one label assigned.</p>
<p><strong>TL;DR</strong>: check out the code at <a href="https://github.com/emmenko/action-verify-pr-labels">https://github.com/emmenko/action-verify-pr-labels</a></p>
<h2>Implementing the GitHub Action</h2>
<p>A GitHub Action is technically just a JavaScript package and thus we need:</p>
<ul><li>A <code>package.json</code>, to list the necessary dependencies and the package main file.</li><li>An <code>action.yml</code>, to describe the <a href="https://help.github.com/en/actions/building-actions/metadata-syntax-for-github-actions">metadata</a> of the action.</li><li>The entry point of the action, usually an <code>index.js</code> file.</li></ul>
<p>To facilitate the implementation of an action, GitHub provides different helper packages. For the action we are going to build, we need the <a href="https://www.npmjs.com/package/@actions/core">@actions/core</a> package and the <a href="https://www.npmjs.com/package/@actions/github">@actions/github</a> package.</p>
<pre>"name": "action-verify-pr-labels",<br/>"version": "1.0.0",<br/>"dependencies": {<br/>"@actions/core": "1.2.4",<br/>"@actions/github": "2.2.0"</pre>
<p>Next, create the <code>action.yml</code> metadata file:</p>
<pre>required: true<br/>using: 'node12'<br/>main: 'index.js'</pre>
<p>Notice that we describe what inputs the action supports. Inputs are key-value parameters that you would <a href="https://help.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idstepswith">pass to the job step</a> with the <code>with</code> option.</p>
<p>In our case, we require the GitHub token for making HTTP API requests using the Oktokit SDK from the <a href="https://www.npmjs.com/package/@actions/github">@actions/github</a> package.</p>
<p>The last thing to do is to write the actual code, in the <code>index.js</code> file.</p>
<h3>Expected behavior</h3>
<p>We expect the action to roughly do the following:</p>
<ul><li>Get the list of assigned labels from the Pull Request.</li><li>If there is a label assigned, and the action runs for the first time, don't do anything.</li><li>If there is no label assigned, trigger a "<strong>Request changes</strong>" status with a comment to remind the user to assign a label.</li><li>If a label gets assigned, and there was a change request from the action bot before, dismiss the review.</li></ul>
<h3>Getting down to business</h3>
<p>Since we're going to perform asynchronous operations, we need to prepare the code to deal with Promises. I personally like the <code>async/await</code> syntax, so I'm going to use that.</p>
<pre>const core = require('@actions/core');<br/>(async () =&gt; {<br/>try {<br/>} catch (error) {<br/>await core.setFailed(error.stack || error.message);<br/>}<br/>})();</pre>
<blockquote><p>NOTE: we're using an immediately-invoked function expression (IIFE) to use the <code>async/await</code> syntax. There is a <a href="https://github.com/tc39/proposal-top-level-await">new JavaScript syntax proposal</a> to use a top-level <code>await</code>. Until this is natively supported, we're going to use the workaround with the IIFE.</p></blockquote>
<p>The code snippet above is just a basic scaffolding for running some asynchronous JavaScript code and handle possible errors. In case there is an error, we're using the <code>core.setFailed</code> helper function to make the action fail.</p>
<h4>Initializing Oktokit HTTP Client</h4>
<p>The next thing to do is to prepare all the necessary information from the GitHub Action workflow.</p>
<pre>const core = require('@actions/core');<br/>const github = require('@actions/github');<br/>(async () =&gt; {<br/>try {<br/>const owner = github.context.repo.owner;<br/>const repo = github.context.repo.repo;<br/>const ref = github.context.ref;<br/>const gitHubToken = core.getInput('github-token', { required: true });<br/>const octokit = new GitHub(gitHubToken);<br/>} catch (error) {<br/>await core.setFailed(error.stack || error.message);<br/>}<br/>})();</pre>
<p>Here we're getting some information from the <code>github.context</code> object, the GitHub token from the input parameter <code>github-token</code>, and we're initializing the Oktokit SDK client to make HTTP API requests.</p>
<h4>Getting the Pull Request labels</h4>
<p>The next step is to get the Pull Request labels. To do that, we need to know the Pull Request number.</p>
<pre>const core = require('@actions/core');<br/>const github = require('@actions/github');<br/>const getPullRequestNumber = (ref) =&gt; {<br/>  core.debug(`Parsing ref: ${ref}`);<br/>const prNumber = ref.replace(/refs\/pull\/(\d+)\/merge/, '$1');<br/>return parseInt(prNumber, 10);<br/>(async () =&gt; {<br/>try {<br/>const owner = github.context.repo.owner;<br/>const repo = github.context.repo.repo;<br/>const ref = github.context.ref;<br/>const prNumber = github.context.issue.number || getPullRequestNumber(ref);<br/>const gitHubToken = core.getInput('github-token', { required: true });<br/>const octokit = new GitHub(gitHubToken);<br/>const getPrLabels = async (prNumber) =&gt; {<br/>const { data } = await octokit.pulls.get({<br/>        pull_number: prNumber,<br/>        owner,<br/>        repo,<br/>});<br/>if (data.length === 0) {<br/>throw new Error(`No Pull Requests found for ${prNumber} (${ref}).`);<br/>}<br/>return data.labels.map((label) =&gt; label.name);<br/>};<br/>const prLabels = await getPrLabels(prNumber);<br/>    core.debug(`Found PR labels: ${prLabels.toString()}`);<br/>} catch (error) {<br/>await core.setFailed(error.stack || error.message);<br/>})();</pre>
<p>The Pull Request number can be derived by the <code>issue.number</code> (depending on how the action is triggered) or by inspecting the Pull Request <code>ref</code>.</p>
<p>With the list of potentially assigned labels, we can now start to implement the logic for the requirements that we initially defined.</p>
<h4>Updating the Pull Request review status</h4>
<p>Let's start with the basics. If the Pull Request has labels assigned, we exit the process and don't do anything. If not, we create a "<strong>Request Changes</strong>" review, with a friendly message.</p>
<pre>const core = require('@actions/core');<br/>const github = require('@actions/github');<br/>const getPullRequestNumber = (ref) =&gt; {<br/>  core.debug(`Parsing ref: ${ref}`);<br/>const prNumber = ref.replace(/refs\/pull\/(\d+)\/merge/, '$1');<br/>return parseInt(prNumber, 10);<br/>(async () =&gt; {<br/>try {<br/>const owner = github.context.repo.owner;<br/>const repo = github.context.repo.repo;<br/>const ref = github.context.ref;<br/>const prNumber = github.context.issue.number || getPullRequestNumber(ref);<br/>const gitHubToken = core.getInput('github-token', { required: true });<br/>const octokit = new GitHub(gitHubToken);<br/>const getPrLabels = async (prNumber) =&gt; {<br/>const { data } = await octokit.pulls.get({<br/>        pull_number: prNumber,<br/>        owner,<br/>        repo,<br/>});<br/>if (data.length === 0) {<br/>throw new Error(`No Pull Requests found for ${prNumber} (${ref}).`);<br/>}<br/>return data.labels.map((label) =&gt; label.name);<br/>};<br/>const prLabels = await getPrLabels(prNumber);<br/>    core.debug(`Found PR labels: ${prLabels.toString()}`);<br/>if (prLabels.length &gt; 0) {<br/>      core.info(`Pull Request has at least a label. All good!`);<br/>return<br/>}<br/>const reviewMessage = `ðŸ‘‹ Hi,<br/>await octokit.pulls.createReview({<br/>      owner,<br/>      repo,<br/>      pull_number: prNumber,<br/>      body: reviewMessage,<br/>});<br/>} catch (error) {<br/>await core.setFailed(error.stack || error.message);<br/>})();</pre>
<h4>Dismissing a stale review</h4>
<p>If the Pull Request has at least one label assigned and there was previously a change request, we need to dismiss the stale review.</p>
<p>To do so, we get the status of the <strong>last review</strong> from the action bot and check if it's not been <code>DISMISSED</code>.</p>
<pre>const core = require('@actions/core');<br/>const github = require('@actions/github');<br/>const getPullRequestNumber = (ref) =&gt; {<br/>  core.debug(`Parsing ref: ${ref}`);<br/>const prNumber = ref.replace(/refs\/pull\/(\d+)\/merge/, '$1');<br/>return parseInt(prNumber, 10);<br/>(async () =&gt; {<br/>try {<br/>const owner = github.context.repo.owner;<br/>const repo = github.context.repo.repo;<br/>const ref = github.context.ref;<br/>const prNumber = github.context.issue.number || getPullRequestNumber(ref);<br/>const gitHubToken = core.getInput('github-token', { required: true });<br/>const octokit = new GitHub(gitHubToken);<br/>const getPrLabels = async (prNumber) =&gt; {<br/>const { data } = await octokit.pulls.get({<br/>        pull_number: prNumber,<br/>        owner,<br/>        repo,<br/>});<br/>if (data.length === 0) {<br/>throw new Error(`No Pull Requests found for ${prNumber} (${ref}).`);<br/>}<br/>return data.labels.map((label) =&gt; label.name);<br/>};<br/>const prLabels = await getPrLabels(prNumber);<br/>    core.debug(`Found PR labels: ${prLabels.toString()}`);<br/>const reviews = await octokit.pulls.listReviews({<br/>      owner,<br/>      repo,<br/>      pull_number: prNumber,<br/>});<br/>const allReviewsFromActionsBot = reviews.data.filter(<br/>(review) =&gt; review.user.login === 'github-actions[bot]'<br/>);<br/>      allReviewsFromActionsBot.length &gt; 0 &amp;&amp;<br/>      allReviewsFromActionsBot[allReviewsFromActionsBot.length - 1];<br/>    core.debug(<br/>`Last review from actions bot: ${JSON.stringify(<br/>)}`<br/>);<br/>if (prLabels.length &gt; 0) {<br/>      core.info(`Pull Request has at least a label. All good!`);<br/>if (<br/>        lastReviewFromActionsBot.state !== 'DISMISSED'<br/>) {<br/>await octokit.pulls.dismissReview({<br/>          owner,<br/>          repo,<br/>          pull_number: prNumber,<br/>          review_id: lastReviewFromActionsBot.id,<br/>          message: 'All good!',<br/>});<br/>}<br/>return<br/>}<br/>const reviewMessage = `ðŸ‘‹ Hi,<br/>await octokit.pulls.createReview({<br/>      owner,<br/>      repo,<br/>      pull_number: prNumber,<br/>      body: reviewMessage,<br/>});<br/>} catch (error) {<br/>await core.setFailed(error.stack || error.message);<br/>}<br/>})();</pre>
<h4>Skipping if changes were already requested</h4>
<p>As a last improvement, we can check if the last review from the action bot is a <code>CHANGES_REQUESTED</code>, in which case we can exit and avoid requesting yet another change.</p>
<pre>const core = require('@actions/core');<br/>const github = require('@actions/github');<br/>const getPullRequestNumber = (ref) =&gt; {<br/>  core.debug(`Parsing ref: ${ref}`);<br/>const prNumber = ref.replace(/refs\/pull\/(\d+)\/merge/, '$1');<br/>return parseInt(prNumber, 10);<br/>(async () =&gt; {<br/>try {<br/>const owner = github.context.repo.owner;<br/>const repo = github.context.repo.repo;<br/>const ref = github.context.ref;<br/>const prNumber = github.context.issue.number || getPullRequestNumber(ref);<br/>const gitHubToken = core.getInput('github-token', { required: true });<br/>const octokit = new GitHub(gitHubToken);<br/>const getPrLabels = async (prNumber) =&gt; {<br/>const { data } = await octokit.pulls.get({<br/>        pull_number: prNumber,<br/>        owner,<br/>        repo,<br/>});<br/>if (data.length === 0) {<br/>throw new Error(`No Pull Requests found for ${prNumber} (${ref}).`);<br/>}<br/>return data.labels.map((label) =&gt; label.name);<br/>};<br/>const prLabels = await getPrLabels(prNumber);<br/>    core.debug(`Found PR labels: ${prLabels.toString()}`);<br/>const reviews = await octokit.pulls.listReviews({<br/>      owner,<br/>      repo,<br/>      pull_number: prNumber,<br/>});<br/>const allReviewsFromActionsBot = reviews.data.filter(<br/>(review) =&gt; review.user.login === 'github-actions[bot]'<br/>);<br/>      allReviewsFromActionsBot.length &gt; 0 &amp;&amp;<br/>      allReviewsFromActionsBot[allReviewsFromActionsBot.length - 1];<br/>    core.debug(<br/>`Last review from actions bot: ${JSON.stringify(<br/>)}`<br/>);<br/>if (prLabels.length &gt; 0) {<br/>      core.info(`Pull Request has at least a label. All good!`);<br/>if (<br/>        lastReviewFromActionsBot.state !== 'DISMISSED'<br/>) {<br/>await octokit.pulls.dismissReview({<br/>          owner,<br/>          repo,<br/>          pull_number: prNumber,<br/>          review_id: lastReviewFromActionsBot.id,<br/>          message: 'All good!',<br/>});<br/>}<br/>return<br/>}<br/>if (<br/>      lastReviewFromActionsBot.state === 'CHANGES_REQUESTED'<br/>) {<br/>      core.info(`Skipping REQUEST_CHANGES review`);<br/>return;<br/>}<br/>const reviewMessage = `ðŸ‘‹ Hi,<br/>await octokit.pulls.createReview({<br/>      owner,<br/>      repo,<br/>      pull_number: prNumber,<br/>      body: reviewMessage,<br/>});<br/>} catch (error) {<br/>await core.setFailed(error.stack || error.message);<br/>}<br/>})();</pre>
<h2>Testing the action</h2>
<p>Now that we finished implementing our GitHub Action, we can test it in the same repository.</p>
<p>Create a <code>.github/workflow/main.yml</code> workflow file:</p>
<pre>on:<br/>types: [ready_for_review, review_requested, labeled, unlabeled]<br/>if: github.event.pull_request.draft == false<br/>runs-on: ubuntu-latest<br/>steps:<br/>- name: Checkout<br/>uses: actions/checkout@v2<br/>- name: Install github actions dependencies<br/>uses: bahmutov/npm-install@v1.1.0<br/>- name: Verify Pull Request Labels<br/>uses: ./<br/>with:<br/>github-token: '${{ secrets.GITHUB_TOKEN }}'</pre>
<p>When you open the Pull Request (depending on the type of triggers), the action should run and request changes. After assigning a label, the action runs again and dismisses the stale review.</p>
<figure> <img alt="Example of running the GitHub Action on a Pull Request" sizes="(max-width: 960px) 100vw, 960px" src="https://emmenko.org/static/2c1a38e5e3f210c81a2e32ce221fc7fd/6ad32/github-action-verify-pr-labels-example.png" srcset="https://emmenko.org/static/2c1a38e5e3f210c81a2e32ce221fc7fd/5243c/github-action-verify-pr-labels-example.png 240w,/static/2c1a38e5e3f210c81a2e32ce221fc7fd/ab158/github-action-verify-pr-labels-example.png"/> <figcaption>Example of running the GitHub Action on a Pull Request</figcaption></figure>
<h2>Publishing the action (optional)</h2>
<p>At this point the GitHub Action is done. People can use it by referencing the GitHub repository:</p>
<pre>uses: emmenko/action-verify-pr-labels@master<br/>with:<br/>github-token: '${{ secrets.GITHUB_TOKEN }}'</pre>
<p>Additionally, you can choose to <a href="https://help.github.com/en/actions/creating-actions/publishing-actions-in-github-marketplace">publish the action to the GitHub Marketplace</a> and tag a git version.</p>
<h2>Conclusion</h2>
<p>Developing GitHub Actions is not too hard. At the end of the day is "just JavaScript", and GitHub provides an accessible framework to make it as simple as possible.</p>
<p>Hopefully this article gives you the motivation and the confidence to try it out for yourself to build amazing actions.</p>
<p>Â© 2026</p>
