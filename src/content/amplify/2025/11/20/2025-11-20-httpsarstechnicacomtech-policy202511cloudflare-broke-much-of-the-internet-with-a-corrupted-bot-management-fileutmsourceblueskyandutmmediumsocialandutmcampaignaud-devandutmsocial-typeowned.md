---
author: Jon Brodkin
cover_image: >-
  https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-1152x648-1763584433.jpg
date: '2025-11-20T16:20:40.619Z'
dateFolder: 2025/11/20
description: >-
  “I worry this is the big botnet flexing,” CEO said. But outage was
  self-inflicted.
isBasedOn: >-
  https://arstechnica.com/tech-policy/2025/11/cloudflare-broke-much-of-the-internet-with-a-corrupted-bot-management-file/?utm_source=bluesky&utm_medium=social&utm_campaign=aud-dev&utm_social-type=owned
link: >-
  https://arstechnica.com/tech-policy/2025/11/cloudflare-broke-much-of-the-internet-with-a-corrupted-bot-management-file/?utm_source=bluesky&utm_medium=social&utm_campaign=aud-dev&utm_social-type=owned
slug: >-
  2025-11-20-httpsarstechnicacomtech-policy202511cloudflare-broke-much-of-the-internet-with-a-corrupted-bot-management-fileutmsourceblueskyandutmmediumsocialandutmcampaignaud-devandutmsocial-typeowned
tags:
  - tech
  - infosec
title: Massive Cloudflare outage was triggered by file that suddenly doubled in size
---
<figure></figure><p>  Cloudflare explains outage </p>
<p>“I worry this is the big botnet flexing,” CEO said. But outage was self-inflicted.</p>
<p><a href="https://arstechnica.com/author/jon-brodkin/"> Jon Brodkin </a> –  Nov 19, 2025 4:25 PM |</p>
<figure><a data-cropped="true" data-pswp-height="1667" data-pswp-srcset="https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error.jpg 2500w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-640x427.jpg 640w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-1024x683.jpg 1024w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-768x512.jpg 768w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-1536x1024.jpg 1536w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-2048x1366.jpg 2048w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-980x653.jpg 980w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-1440x960.jpg 1440w" data-pswp-width="2500" href="https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error.jpg"><img alt='A webpage error message says, "Internal server error, visit cloudflare.com for more information."' sizes="(max-width: 1152px) 100vw, 1152px" src="https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-1536x864-1763584433.jpg" srcset="https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-1152x648-1763584433.jpg 1152w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-384x216-1763584431.jpg 384w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-768x432-1763584432.jpg 768w, https://cdn.arstechnica.net/wp-content/uploads/2025/11/cloudflare-error-1536x864-1763584433.jpg 1536w"/></a></figure>
<p>An error message seen during the Cloudflare outage on November 18, 2025.  / Credit: Getty Images | NurPhoto</p>
<figure></figure><figure></figure><p>When a Cloudflare outage <a href="https://arstechnica.com/tech-policy/2025/11/widespread-cloudflare-outage-blamed-on-mysterious-traffic-spike/">disrupted large numbers</a> of websites and online services yesterday, the company initially thought it was hit by a “hyper-scale” DDoS (distributed denial-of-service) attack.</p>
<p>“I worry this is the big botnet flexing,” Cloudflare co-founder and CEO Matthew Prince wrote in an internal chat room yesterday, while he and others discussed whether Cloudflare was being hit by attacks from the prolific <a href="https://techcommunity.microsoft.com/blog/azureinfrastructureblog/defending-the-cloud-azure-neutralized-a-record-breaking-15-tbps-ddos-attack/4470422">Aisuru botnet</a>. But upon further investigation, Cloudflare staff realized the problem had an internal cause: an important file had unexpectedly doubled in size and propagated across the network.</p>
<p>This caused trouble for software that needs to read the file to maintain the Cloudflare <a href="https://www.cloudflare.com/application-services/products/bot-management/">bot management system</a> that uses a machine learning model to protect against security threats. Cloudflare’s core CDN, security services, and several other services were affected.</p>
<p>“After we initially wrongly suspected the symptoms we were seeing were caused by a hyper-scale DDoS attack, we correctly identified the core issue and were able to stop the propagation of the larger-than-expected feature file and replace it with an earlier version of the file,” Prince wrote in a <a href="https://blog.cloudflare.com/18-november-2025-outage/">post-mortem</a> of the outage.</p>
<p>Prince explained that the problem “was triggered by a change to one of our database systems’ permissions which caused the database to output multiple entries into a ‘feature file’ used by our Bot Management system. That feature file, in turn, doubled in size. The larger-than-expected feature file was then propagated to all the machines that make up our network.”</p>
<p>These machines run software that routes traffic across the Cloudflare network. The software “reads this feature file to keep our Bot Management system up to date with ever changing threats,” Prince wrote. “The software had a limit on the size of the feature file that was below its doubled size. That caused the software to fail.”</p>
<figure><h3>Ars Video</h3><a href="https://www.arstechnica.com/video/watch/how-the-callisto-protocol-designed-its-terrifying-immersive-audio"><h3>How The Callisto Protocol's Team Designed Its Terrifying, Immersive Audio</h3></a></figure>
<h2>Sorry for the pain, Internet</h2>
<p>After replacing the bloated feature file with an earlier version, the flow of core traffic “largely” returned to normal, Prince wrote. But it took another two and a half hours “to mitigate increased load on various parts of our network as traffic rushed back online.”</p>
<p><a href="https://arstechnica.com/gadgets/2025/10/a-single-point-of-failure-triggered-the-amazon-outage-affecting-millions/">Like Amazon Web Services</a>, Cloudflare is relied upon by many online services and can take down much of the web when it has a technical problem. “On behalf of the entire team at Cloudflare, I would like to apologize for the pain we caused the Internet today,” Prince wrote, saying that any outage is unacceptable because of “Cloudflare’s importance in the Internet ecosystem.”</p>
<p>Cloudflare’s bot management system classifies bots as good or bad with “a machine learning model that we use to generate bot scores for every request traversing our network,” Prince wrote. “Our customers use bot scores to control which bots are allowed to access their sites—or not.”</p>
<p>Prince explained that the configuration file this system relies upon describes “features,” or individual traits “used by the machine learning model to make a prediction about whether the request was automated or not.” This file is updated every five minutes “and published to our entire network and allows us to react to variations in traffic flows across the Internet. It allows us to react to new types of bots and new bot attacks. So it’s critical that it is rolled out frequently and rapidly as bad actors change their tactics quickly.”</p>
<h2>Unexpected query response</h2>
<p>Each new version of the file is generated by a query running on a ClickHouse database cluster, Prince wrote. When Cloudflare made a change granting additional permissions to database users, the query response suddenly contained more metadata than it previously had.</p>
<p>Cloudflare staff assumed “that the list of columns returned by a query like this would only include the ‘default’ database.” But the query didn’t include a filter for the database name, causing it to return duplicates of columns, Prince wrote.</p>
<p>This is the type of query that Cloudflare’s bot management system uses “to construct each input ‘feature’ for the file,” he wrote. The extra metadata more than doubled the rows in the response, “ultimately affecting the number of rows (i.e. features) in the final file output,” Prince wrote.</p>
<p>Cloudflare’s proxy service has limits to prevent excessive memory consumption, with the bot management system having “a limit on the number of machine learning features that can be used at runtime.” This limit is 200, well above the actual number of features used.</p>
<p>“When the bad file with more than 200 features was propagated to our servers, this limit was hit—resulting in the system panicking” and outputting errors, Prince wrote.</p>
<h2>Worst Cloudflare outage since 2019</h2>
<p>The number of 5xx error HTTP status codes served by the Cloudflare network is normally “very low” but soared after the bad file spread across the network. “The spike, and subsequent fluctuations, show our system failing due to loading the incorrect feature file,” Prince wrote. “What’s notable is that our system would then recover for a period. This was very unusual behavior for an internal error.”</p>
<p>This unusual behavior was explained by the fact “that the file was being generated every five minutes by a query running on a ClickHouse database cluster, which was being gradually updated to improve permissions management,” Prince wrote. “Bad data was only generated if the query ran on a part of the cluster which had been updated. As a result, every five minutes there was a chance of either a good or a bad set of configuration files being generated and rapidly propagated across the network.”</p>
<p>This fluctuation initially “led us to believe this might be caused by an attack. Eventually, every ClickHouse node was generating the bad configuration file and the fluctuation stabilized in the failing state,” he wrote.</p>
<p>Prince said that Cloudflare “solved the problem by stopping the generation and propagation of the bad feature file and manually inserting a known good file into the feature file distribution queue,” and then “forcing a restart of our core proxy.” The team then worked on “restarting remaining services that had entered a bad state” until the 5xx error code volume returned to normal later in the day.</p>
<p>Prince said the outage was Cloudflare’s worst <a href="https://blog.cloudflare.com/details-of-the-cloudflare-outage-on-july-2-2019/">since 2019</a> and that the firm is taking steps to protect against similar failures in the future. Cloudflare will work on “hardening ingestion of Cloudflare-generated configuration files in the same way we would for user-generated input; enabling more global kill switches for features; eliminating the ability for core dumps or other error reports to overwhelm system resources; [and] reviewing failure modes for error conditions across all core proxy modules,” according to Prince.</p>
<p>While Prince can’t promise that Cloudflare will never have another outage of the same scale, he said that previous outages have “always led to us building new, more resilient systems.”</p>
<figure><a href="https://arstechnica.com/author/jon-brodkin/"><img alt="Photo of Jon Brodkin" src="https://cdn.arstechnica.net/wp-content/uploads/2016/05/j.brodkin-11_2.jpg"/></a></figure>
<p><a href="https://arstechnica.com/author/jon-brodkin/"> Jon Brodkin </a> Senior IT Reporter</p>
<p>Jon is a Senior IT Reporter for Ars Technica. He covers the telecom industry, Federal Communications Commission rulemakings, broadband consumer affairs, court cases, and government regulation of the tech industry.</p>
