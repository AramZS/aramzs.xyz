---
author: Henri Bredt
cover_image: 'https://miro.medium.com/v2/resize:fit:1012/1*NyU_kOo1_1PF9FxmU_MUFg.png'
date: '2025-11-25T19:03:53.683Z'
dateFolder: 2025/11/25
description: >-
  I wanted to create a Share Extension for my app Thoughtsâ€Šâ€”â€ŠInspiration Manager
  with the UI build in SwiftUI. The Share Extension APIâ€¦
isBasedOn: >-
  https://medium.com/@henribredtprivat/create-an-ios-share-extension-with-custom-ui-in-swift-and-swiftui-2023-6cf069dc1209
link: >-
  https://medium.com/@henribredtprivat/create-an-ios-share-extension-with-custom-ui-in-swift-and-swiftui-2023-6cf069dc1209
slug: >-
  2025-11-25-httpsmediumcomhenribredtprivatcreate-an-ios-share-extension-with-custom-ui-in-swift-and-swiftui-2023-6cf069dc1209
tags:
  - code
title: Create an iOS Share Extension with custom UI in Swift and SwiftUI (2023)
---
<p>I wanted to create a <a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/Share.html">Share Extension</a> for my app <a href="http://thoughts-app.com">Thoughts â€” Inspiration Manager</a> with the UI build in SwiftUI. The Share Extension API hasnâ€™t been update by Apple in quite some time and is made for UIKit. In this article I share how I worked around this and reused SwiftUI views from my main app in the Share Extension.</p>
<article class="rw-embedded-tweet" data-rw-tweet-id="1709850664828883008">
<header class="rw-embedded-tweet-header">
<div>
<img src="https://pbs.twimg.com/profile_images/1700850427590295552/bJTpH-0U.jpg"/>
</div>
<div>
<span><a href="https://twitter.com/henricreates">Henri @WWDC24</a></span>
<span><a href="https://twitter.com/henricreates">@henricreates</a></span>
</div>
<div>
<a href="https://twitter.com/henricreates/status/1709850664828883008">
<svg fill="none" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M19.9525 7.98316C19.9647 8.15675 19.9647 8.33034 19.9647 8.50553C19.9647 13.8436 15.8371 20 8.28966 20V19.9968C6.06013 20 3.8769 19.3712 2 18.1857C2.32419 18.2241 2.65001 18.2433 2.97664 18.2441C4.82429 18.2457 6.61913 17.6353 8.07272 16.5114C6.31688 16.4786 4.77717 15.3515 4.23928 13.706C4.85436 13.8228 5.48812 13.7988 6.09181 13.6364C4.17753 13.2556 2.80033 11.5997 2.80033 9.67665C2.80033 9.65905 2.80033 9.64225 2.80033 9.62545C3.37071 9.93824 4.00934 10.1118 4.6626 10.131C2.85964 8.9447 2.30388 6.58325 3.39265 4.73696C5.47593 7.2608 8.54966 8.79511 11.8493 8.9575C11.5186 7.55439 11.9703 6.08408 13.0364 5.09774C14.689 3.56824 17.2882 3.64663 18.8418 5.27293C19.7607 5.09454 20.6415 4.76256 21.4475 4.29219C21.1412 5.22733 20.5001 6.02168 19.6437 6.52645C20.457 6.43206 21.2517 6.21767 22 5.89049C21.4491 6.70324 20.7552 7.41119 19.9525 7.98316Z" fill="currentColor"></path>
</svg>
</a>
</div>
</header>
<main>
<p>I've been working on a Share Extension for Thoughts, allowing to you quickly add any text to your inbox in Thoughts :D This was trickier than I expected, but seems to be working fine now :D</p><video controls=""><source src="https://video.twimg.com/ext_tw_video/1709850318517760000/pu/pl/sE4SHhSz3SJi_e_T.m3u8?tag=12" type="application/x-mpegURL"/><source src="https://video.twimg.com/ext_tw_video/1709850318517760000/pu/vid/avc1/480x270/3awQ-GXMTcUXB_-c.mp4?tag=12" type="video/mp4"/><source src="https://video.twimg.com/ext_tw_video/1709850318517760000/pu/vid/avc1/640x360/tkA7H_apjF4XKnsD.mp4?tag=12" type="video/mp4"/><source src="https://video.twimg.com/ext_tw_video/1709850318517760000/pu/vid/avc1/1280x720/kNzwnn5Oyao_W20W.mp4?tag=12" type="video/mp4"/>Your browser does not support the video tag.</video>
</main>
<footer class="rw-embedded-tweet-footer" data-rw-created-timestamp="1696495140000">
<span>
<a href="https://twitter.com/henricreates/status/1709850664828883008">Posted Oct 5, 2023 at 8:39AM</a>
</span>
</footer>
</article>
<p><em>Hereâ€™s what I wanted to achieve:</em> Any selected text should be shareable with my App via the Share Extension. The Extension should show a Sheet with custom UI in which the user can edit the text and add additional info. Sounds simple, but I found that the documentation wasnâ€™t all that detailed and that other tutorials didnâ€™t work or were written for UIKit â€” so it took me some research to figure things out. Hereâ€™s what we will build in this tutorial:</p>
<figure><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png 1400w"/><img alt="" src="https://miro.medium.com/v2/resize:fit:700/1*8nKHXbXl9hzFJ5ZGqlg3Yw.png"/></picture><figcaption>What we will be building in this tutorial</figcaption></figure>
<h3 data-selectable-paragraph="">Step 1: Add a Share Extension target to your project</h3>
<p>Click the <strong>+</strong> Button or choose <strong>File â–¸ New â–¸ Target </strong>from Xcodes menu, then search for and select <em>Share Extension</em>. Enter a name and create the new target. When Xcodes asks you to activate the scheme select activate.</p>
<figure><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qf2mwo4AaSV18CTMqER-vg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qf2mwo4AaSV18CTMqER-vg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qf2mwo4AaSV18CTMqER-vg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qf2mwo4AaSV18CTMqER-vg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qf2mwo4AaSV18CTMqER-vg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qf2mwo4AaSV18CTMqER-vg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qf2mwo4AaSV18CTMqER-vg.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*qf2mwo4AaSV18CTMqER-vg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qf2mwo4AaSV18CTMqER-vg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qf2mwo4AaSV18CTMqER-vg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qf2mwo4AaSV18CTMqER-vg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qf2mwo4AaSV18CTMqER-vg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qf2mwo4AaSV18CTMqER-vg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qf2mwo4AaSV18CTMqER-vg.png 1400w"/><img alt="" src="https://miro.medium.com/v2/resize:fit:700/1*qf2mwo4AaSV18CTMqER-vg.png"/></picture><figcaption>Add a Share Extension target</figcaption></figure>
<p>You will now find a new Group and some files in the Project Navigator. Xcode has automatically created a <em>UIViewController</em> subclass of type <em>SLComposeServiceViewController</em> in <em>ShareViewController.swift.</em> Youâ€™ll notice that by default Xcode has also created a <em>MainInterface.storyboard</em> and <em>Info.plist </em>file. You can run the project and test the default Share Extension, which was made to post content on a social media platform â€” not quite what we want yet, but you can give it a try.</p>
<figure><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*amhFDHWjNSUG2V0e06oypA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*amhFDHWjNSUG2V0e06oypA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*amhFDHWjNSUG2V0e06oypA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*amhFDHWjNSUG2V0e06oypA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*amhFDHWjNSUG2V0e06oypA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*amhFDHWjNSUG2V0e06oypA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*amhFDHWjNSUG2V0e06oypA.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*amhFDHWjNSUG2V0e06oypA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*amhFDHWjNSUG2V0e06oypA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*amhFDHWjNSUG2V0e06oypA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*amhFDHWjNSUG2V0e06oypA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*amhFDHWjNSUG2V0e06oypA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*amhFDHWjNSUG2V0e06oypA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*amhFDHWjNSUG2V0e06oypA.png 1400w"/><img alt="" src="https://miro.medium.com/v2/resize:fit:700/1*amhFDHWjNSUG2V0e06oypA.png"/></picture><figcaption>The default Share Extension â€” not quite what we want.</figcaption></figure>
<h3 data-selectable-paragraph="">Step 2: Set Activation Rule</h3>
<p>Before we add custom UI, we have to configure the Share Extension. iOS needs to know for what kind of data your Share Extension should be shown. You can specify that in the <em>Info.plist</em> file of the Extension. By default you will see the key <em>NSExtensionActivationRule</em> has the value <em>TRUEPREDICATE</em> which means that the Share Extension will always be shown. Since we want our Share Extension only to be shown when Text was selected, we modify the<em> NSExtensionActivationRule</em>. Change the Type of the <em>NSExtensionActivationRule</em> from <em>String</em> to <em>Dictionary</em>. This will allow you to specify multiple allowed types. Click the small <strong>+ </strong>to create a new Item. Our Extension should only support Text, so add the key <em>NSExtensionActivationSupportsText </em>of Type<em> Boolean </em>and set the Value to<em> YES.</em></p>
<figure><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 618px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8j53I3oXjpatWE5NOl6Ytw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8j53I3oXjpatWE5NOl6Ytw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8j53I3oXjpatWE5NOl6Ytw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8j53I3oXjpatWE5NOl6Ytw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8j53I3oXjpatWE5NOl6Ytw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8j53I3oXjpatWE5NOl6Ytw.png 1100w, https://miro.medium.com/v2/resize:fit:1236/format:webp/1*8j53I3oXjpatWE5NOl6Ytw.png 1236w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 618px" srcset="https://miro.medium.com/v2/resize:fit:640/1*8j53I3oXjpatWE5NOl6Ytw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8j53I3oXjpatWE5NOl6Ytw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8j53I3oXjpatWE5NOl6Ytw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8j53I3oXjpatWE5NOl6Ytw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8j53I3oXjpatWE5NOl6Ytw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8j53I3oXjpatWE5NOl6Ytw.png 1100w, https://miro.medium.com/v2/resize:fit:1236/1*8j53I3oXjpatWE5NOl6Ytw.png 1236w"/><img alt="" src="https://miro.medium.com/v2/resize:fit:618/1*8j53I3oXjpatWE5NOl6Ytw.png"/></picture><figcaption>Info.plist</figcaption></figure>
<p>Other Activation Rules are available, read more in <a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/AppExtensionKeys.html#//apple_ref/doc/uid/TP40014212-SW2">Appleâ€™s Developer Documentation</a>. After setting the Activation Rule, your Share Extension will only be shown in the system share sheet for the corresponding file types, in our case when Text is to be shared.</p>
<h3 data-selectable-paragraph="">Step 3: Prepare the project to show your own UI</h3>
<p>The default UI Apple presents is rarely useful and we want to show our own UI, build in SwiftUI. As we have seen, the Share Extension is build with UIKit, so weâ€™ll have to bridge to SwiftUI with a <em>UIHostingController</em>.</p>
<p>Letâ€™s prepare the project to show custom UI first. Remove all default code from <em>ShareViewController.swift</em> and create a simple <em>UIViewController</em>.</p>
<pre>import UIKit<br/><br/>class ShareViewController: UIViewController {<br/><br/>    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>    }<br/><br/>}<br/></pre>
<p>You can then delete the <em>MainInterface.storyboard</em> fileâ€”feels so good to get rid of this :D. We now need to tell the Share Extension, that <em>ShareViewController.swift </em>should be responsible for showing the UI. Open the <em>Info.plist</em> file. You will see a key <em>NSExtensionMainStoryboard</em> that references the storyboard file we have just deleted. Change that key to <em>NSExtensionPrincipalClass </em>and set the value to <em>&lt;NameOfTheShareTarget&gt;.ShareViewController</em>. Itâ€™s important to put the name of the Share Target first, so Xcode can find the file.</p>
<figure><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 679px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jHvF39BQu6I28AxPBZ6_RA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jHvF39BQu6I28AxPBZ6_RA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jHvF39BQu6I28AxPBZ6_RA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jHvF39BQu6I28AxPBZ6_RA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jHvF39BQu6I28AxPBZ6_RA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jHvF39BQu6I28AxPBZ6_RA.png 1100w, https://miro.medium.com/v2/resize:fit:1358/format:webp/1*jHvF39BQu6I28AxPBZ6_RA.png 1358w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 679px" srcset="https://miro.medium.com/v2/resize:fit:640/1*jHvF39BQu6I28AxPBZ6_RA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jHvF39BQu6I28AxPBZ6_RA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jHvF39BQu6I28AxPBZ6_RA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jHvF39BQu6I28AxPBZ6_RA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jHvF39BQu6I28AxPBZ6_RA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jHvF39BQu6I28AxPBZ6_RA.png 1100w, https://miro.medium.com/v2/resize:fit:1358/1*jHvF39BQu6I28AxPBZ6_RA.png 1358w"/><img alt="" src="https://miro.medium.com/v2/resize:fit:679/1*jHvF39BQu6I28AxPBZ6_RA.png"/></picture><figcaption>Info.plist</figcaption></figure>
<h3 data-selectable-paragraph="">Step 4: Access the shared data</h3>
<p>We now need to get the data that was shared with the Share Extension. We can access it via the <em>inputItems</em> of the <em>extensionContext</em>. In the next step we ensure we have access to the required data, if not we close the Share Extension immediately with the <em>close()</em> function. You might want to do some proper error handling / logging but that is out of the scope of this article.</p>
<pre>import UIKit<br/><br/>class ShareViewController: UIViewController {<br/>    <br/>    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>        <br/>        // Ensure access to extensionItem and itemProvider<br/>        guard<br/>            let extensionItem = extensionContext?.inputItems.first as? NSExtensionItem,<br/>            let itemProvider = extensionItem.attachments?.first else {<br/>            close()<br/>            return<br/>        }<br/>    }<br/>    <br/>    /// Close the Share Extension<br/>    func close() {<br/>        self.extensionContext?.completeRequest(returningItems: [], completionHandler: nil)<br/>    }<br/>    <br/>}<br/></pre>
<p>After that we check that the provided data is of the correct type, we expect <em>UTType.plainText</em>. If the item does not conform to the Type Identifier, we again close the Share Extension.</p>
<pre>override func viewDidLoad() {<br/>    super.viewDidLoad()<br/>    <br/>    // Ensure access to extensionItem and itemProvider<br/>    guard<br/>        let extensionItem = extensionContext?.inputItems.first as? NSExtensionItem,<br/>        let itemProvider = extensionItem.attachments?.first else {...}<br/>    <br/><br/>    // Check type identifier<br/>    let textDataType = UTType.plainText.identifier<br/>    if itemProvider.hasItemConformingToTypeIdentifier(textDataType) {<br/>       <br/>    } else {<br/>        close()<br/>        return<br/>    }<br/>    <br/>}<br/></pre>
<p>In the next Step we try to load the <em>item</em> from the <em>itemProvider</em> and and convert the provided item to a <em>String</em>. Yet again, if an error occurred or the conversion to a <em>String</em> failed, we close the Share Extension.</p>
<pre>override func viewDidLoad() {<br/>    super.viewDidLoad()<br/>    <br/>    ...<br/><br/>    // Check type identifier<br/>    let textDataType = UTType.plainText.identifier<br/>    if itemProvider.hasItemConformingToTypeIdentifier(textDataType) {<br/>        <br/>        // Load the item from itemProvider<br/>        itemProvider.loadItem(forTypeIdentifier: textDataType , options: nil) { (providedText, error) in<br/>            if let error {<br/>                self.close()<br/>                return<br/>            }<br/>            <br/>            if let text = providedText as? String {<br/>                // if we get here, we're good and can show the View :D<br/>            } else {<br/>                self.close()<br/>                return<br/>            }<br/>        }<br/>        <br/>    } else {...}<br/>}<br/></pre>
<h3 data-selectable-paragraph="">Step 5: Host your SwiftUI with a UIHostingController</h3>
<p>Now weâ€™re ready show a SwiftUI view in a <em>UIHostingViewController</em>. Create a SwiftUI view you want to use as the UI for the Share Extension. This is a simple example that only shows a <em>TextView </em>with the passed <em>text.</em></p>
<pre>import SwiftUI<br/><br/>struct ShareExtensionView: View {<br/>    @State private var text: String<br/>    <br/>    init(text: String) {<br/>        self.text = text<br/>    }<br/>    <br/>    var body: some View {<br/>        NavigationStack{<br/>            VStack(spacing: 20){<br/>                TextField("Text", text: $text, axis: .vertical)<br/>                    .lineLimit(3...6)<br/>                    .textFieldStyle(.roundedBorder)<br/>                <br/>                Button {<br/>                    // TODO: save text<br/>                    // TODO: close()<br/>                } label: {<br/>                    Text("Save")<br/>                        .frame(maxWidth: .infinity)<br/>                }<br/>                .buttonStyle(.borderedProminent)<br/>                <br/>                Spacer()<br/>            }<br/>            .padding()<br/>            .navigationTitle("Share Extension")<br/>            .toolbar {<br/>                Button("Cancel") {<br/>                    // TODO: close()<br/>                }<br/>            }<br/>        }<br/>    }<br/>}<br/></pre>
<p>Replace the <em>save text</em> comment with some code to share the data with your main application. For example, Iâ€™ve created an App Group with a CoreData instance in the App Group and write the data to CoreData from the extension, but there are many other ways. That is out of the scope of this article. <a data-discover="true" href="https://medium.com/plans?source=upgrade_membership---post_li_non_moc_upsell--6cf069dc1209---------------------------------------"><figure><img alt="Become a member" src="https://miro.medium.com/v2/da:true/39309aa989a0b10efa2291d777f51465d571981b6b92231e51a0846a592cb403"/></figure><figure><img alt="Become a member" src="https://miro.medium.com/v2/da:true/d3cd1505b3697d277993a9b714cca5440eef772de587a18a64e4a3c58fd8ef49"/></figure></a> In the next step we present this view in a <em>UIHostingController</em>. We need to explicitly tell that we want the code responsible for showing the view to run on the main thread with <em>DispatchQueue.main.async</em> , because the <em>loadItem</em> closure can be executed on background threads.</p>
<pre>override func viewDidLoad() {<br/>    ...<br/>    <br/>    // Check type identifier<br/>    let textDataType = UTType.plainText.identifier<br/>    if itemProvider.hasItemConformingToTypeIdentifier(textDataType) {<br/>        <br/>        // Load the item from itemProvider<br/>        itemProvider.loadItem(forTypeIdentifier: textDataType , options: nil) { (providedText, error) in<br/>            if let error {...}<br/>            <br/>            if let text = providedText as? String {<br/>                DispatchQueue.main.async {<br/>                    // host the SwiftU view<br/>                    let contentView = UIHostingController(rootView: ShareExtensionView(text: text))<br/>                    self.addChild(contentView)<br/>                    self.view.addSubview(contentView.view)<br/>                    <br/>                    // set up constraints<br/>                    contentView.view.translatesAutoresizingMaskIntoConstraints = false<br/>                    contentView.view.topAnchor.constraint(equalTo: self.view.topAnchor).isActive = true<br/>                    contentView.view.bottomAnchor.constraint (equalTo: self.view.bottomAnchor).isActive = true<br/>                    contentView.view.leftAnchor.constraint(equalTo: self.view.leftAnchor).isActive = true<br/>                    contentView.view.rightAnchor.constraint (equalTo: self.view.rightAnchor).isActive = true<br/>                }<br/>            } else {...}<br/>        }<br/> <br/>    } else {...}<br/>    <br/>}<br/></pre>
<h3 data-selectable-paragraph="">Step 6: Close the Share Extension from SwiftUI</h3>
<p>We can now present our custom UI and access the shared data ðŸ¥³. But we also need to let the SwiftUI view communicate with the <em>ShareViewController.swift</em> to trigger the <em>close()</em> function to dismiss the view when needed. We can do this by utilizing the<em> NotificationCenter. </em>In your<em> ShareExtensionView.swift</em> add a <em>close()</em> function and uncomment the calls of this function.</p>
<pre>import SwiftUI<br/><br/>struct ShareExtensionView: View {<br/>    @State private var text: String<br/>    <br/>    init(text: String) {...}<br/>    <br/>    var body: some View {...}<br/><br/>    func close() {<br/>        NotificationCenter.default.post(name: NSNotification.Name("close"), object: nil)<br/>    }<br/>}<br/></pre>
<p>Now we need to listen for that Notification in <em>ShareViewController.swift</em>. At the end of <em>viewDidLoad</em> add and observer to the default NotificationCenter like this.</p>
<pre>NotificationCenter.default.addObserver(forName: NSNotification.Name("close"), object: nil, queue: nil) { _ in<br/>    DispatchQueue.main.async {<br/>        self.close()<br/>    }<br/>}<br/></pre>
<p>Thatâ€™s it! Congrats, youâ€™ve added a Share Extension with custom UI build in SwiftUI to your app. Hereâ€™s what weâ€™ve build:</p>
<figure><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NyU_kOo1_1PF9FxmU_MUFg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NyU_kOo1_1PF9FxmU_MUFg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NyU_kOo1_1PF9FxmU_MUFg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NyU_kOo1_1PF9FxmU_MUFg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NyU_kOo1_1PF9FxmU_MUFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NyU_kOo1_1PF9FxmU_MUFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NyU_kOo1_1PF9FxmU_MUFg.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*NyU_kOo1_1PF9FxmU_MUFg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NyU_kOo1_1PF9FxmU_MUFg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NyU_kOo1_1PF9FxmU_MUFg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NyU_kOo1_1PF9FxmU_MUFg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NyU_kOo1_1PF9FxmU_MUFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NyU_kOo1_1PF9FxmU_MUFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*NyU_kOo1_1PF9FxmU_MUFg.png 1400w"/><img alt="" src="https://miro.medium.com/v2/resize:fit:700/1*NyU_kOo1_1PF9FxmU_MUFg.png"/></picture></figure>
<h3 data-selectable-paragraph="">Full code</h3>
<p><em>ShareExtensionView.swift:</em></p>
<pre>import SwiftUI<br/><br/>struct ShareExtensionView: View {<br/>    @State private var text: String<br/>    <br/>    init(text: String) {<br/>        self.text = text<br/>    }<br/>    <br/>    var body: some View {<br/>        NavigationStack{<br/>            VStack(spacing: 20){<br/>                TextField("Text", text: $text, axis: .vertical)<br/>                    .lineLimit(3...6)<br/>                    .textFieldStyle(.roundedBorder)<br/>                <br/>                Button {<br/>                    // TODO: save text<br/>                    close()<br/>                } label: {<br/>                    Text("Save")<br/>                        .frame(maxWidth: .infinity)<br/>                }<br/>                .buttonStyle(.borderedProminent)<br/>                <br/>                Spacer()<br/>            }<br/>            .padding()<br/>            .navigationTitle("Share Extension")<br/>            .toolbar {<br/>                Button("Cancel") {<br/>                    close()<br/>                }<br/>            }<br/>        }<br/>    }<br/><br/>    func close() {<br/>        NotificationCenter.default.post(name: NSNotification.Name("close"), object: nil)<br/>    }<br/>}<br/><br/>#Preview {<br/>    ShareExtensionView(text: "Think big!")<br/>}<br/></pre>
<p><em>ShareViewController.swift:</em></p>
<pre>import SwiftUI<br/>import UIKit<br/>import UniformTypeIdentifiers<br/><br/>class ShareViewController: UIViewController {<br/>    <br/>    override func viewDidLoad() {<br/>        super.viewDidLoad()<br/>        <br/>        // Ensure access to extensionItem and itemProvider<br/>        guard<br/>            let extensionItem = extensionContext?.inputItems.first as? NSExtensionItem,<br/>            let itemProvider = extensionItem.attachments?.first else {<br/>            close()<br/>            return<br/>        }<br/>        <br/>        // Check type identifier<br/>        let textDataType = UTType.plainText.identifier<br/>        if itemProvider.hasItemConformingToTypeIdentifier(textDataType) {<br/><br/>            // Load the item from itemProvider<br/>            itemProvider.loadItem(forTypeIdentifier: textDataType , options: nil) { (providedText, error) in<br/>                  if let error {<br/>                      self.close()<br/>                      return<br/>                  }<br/>                <br/>                if let text = providedText as? String {<br/>                    DispatchQueue.main.async {<br/>                        // host the SwiftU view<br/>                        let contentView = UIHostingController(rootView: ShareExtensionView(text: text))<br/>                        self.addChild(contentView)<br/>                        self.view.addSubview(contentView.view)<br/>                        <br/>                        // set up constraints<br/>                        contentView.view.translatesAutoresizingMaskIntoConstraints = false<br/>                        contentView.view.topAnchor.constraint(equalTo: self.view.topAnchor).isActive = true<br/>                        contentView.view.bottomAnchor.constraint (equalTo: self.view.bottomAnchor).isActive = true<br/>                        contentView.view.leftAnchor.constraint(equalTo: self.view.leftAnchor).isActive = true<br/>                        contentView.view.rightAnchor.constraint (equalTo: self.view.rightAnchor).isActive = true<br/>                    }<br/>                } else {<br/>                    self.close()<br/>                    return<br/>                }<br/>                <br/>            }<br/><br/>        } else {<br/>            close()<br/>            return<br/>        }<br/>       <br/>        NotificationCenter.default.addObserver(forName: NSNotification.Name("close"), object: nil, queue: nil) { _ in<br/>            DispatchQueue.main.async {<br/>                self.close()<br/>            }<br/>        }<br/>    }<br/>    <br/>    /// Close the Share Extension<br/>    func close() {<br/>        self.extensionContext?.completeRequest(returningItems: [], completionHandler: nil)<br/>    }<br/>}<br/></pre>
<p><em>Info.plist</em> in the Share Extension:</p>
<pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<br/>&lt;plist version="1.0"&gt;<br/>&lt;dict&gt;<br/> &lt;key&gt;NSExtension&lt;/key&gt;<br/> &lt;dict&gt;<br/>  &lt;key&gt;NSExtensionAttributes&lt;/key&gt;<br/>  &lt;dict&gt;<br/>   &lt;key&gt;NSExtensionActivationRule&lt;/key&gt;<br/>   &lt;dict&gt;<br/>    &lt;key&gt;NSExtensionActivationSupportsText&lt;/key&gt;<br/>    &lt;true/&gt;<br/>   &lt;/dict&gt;<br/>  &lt;/dict&gt;<br/>  &lt;key&gt;NSExtensionPrincipalClass&lt;/key&gt;<br/>  &lt;string&gt;ShareExtension.ShareViewController&lt;/string&gt;<br/>  &lt;key&gt;NSExtensionPointIdentifier&lt;/key&gt;<br/>  &lt;string&gt;com.apple.share-services&lt;/string&gt;<br/> &lt;/dict&gt;<br/>&lt;/dict&gt;<br/>&lt;/plist&gt;<br/></pre>
<p>Thanks for reading, I hope this works for you and you could save you some time! If you have a suggestion for an improvement, please let me know so that we can learn from each other :D If youâ€™d like to see my implementation in action, you can get my app <a href="https://apps.apple.com/us/app/thoughts-inspiration-manager/id6444917751">Thoughts â€” Inspiration Manager</a> for free on the App Store.</p>
<p>All the best,<br/>
<a href="https://twitter.com/henricreates">Henri</a></p>
<h3 data-selectable-paragraph="">Helpful links</h3>
<ul><li data-selectable-paragraph=""><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/Share.html">https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/Share.html</a></li><li data-selectable-paragraph=""><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html#//apple_ref/doc/uid/TP40014214-CH21-SW8">https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html#//apple_ref/doc/uid/TP40014214-CH21-SW8</a></li><li data-selectable-paragraph=""><a data-discover="true" href="https://medium.com/macoclock/ios-share-extension-swift-5-1-1606263746b">https://medium.com/macoclock/ios-share-extension-swift-5-1-1606263746b</a></li><li data-selectable-paragraph=""><a href="https://www.9series.com/blog/build-share-extension-ios-using-swift/">https://www.9series.com/blog/build-share-extension-ios-using-swift/</a></li></ul>
